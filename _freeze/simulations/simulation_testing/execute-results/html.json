{
  "hash": "feb315130026d25d5daddf45316226fe",
  "result": {
    "engine": "knitr",
    "markdown": "---\nbibliography: ../references.bib\n---\n\n\n\n\n# Simulation Testing\n\n\n\n\n::: {.cell}\n\n:::\n\n\n\n\n## Introduction\n\nTesting a proposed model against simulated data generated from a known underlying process is an important but sometimes overlooked step in ecological research [@austin2006; @lotterhos2022]. In fisheries science, simulation testing is commonly used to evaluate stock assessment and population dynamic models and assess their robustness to various types of error [@deroba2015; @piner2011].\n\nBefore applying the size-at-maturity estimation procedures identified through the systematic review to real data, I will create multiple simulated data sets with differing characteristics in order to determine the domains of applicability and inference of each model. The domain of applicability refers to the types of data sets to which a model can reliably be applied, while the domain of inference is defined as the processes or conclusions that can be inferred from the model output [@lotterhos2022]. The methodology for this chapter will be heavily influenced by the principles for ecological simulation testing outlined by Lotterhos et al. [-@lotterhos2022] and the guidelines for computational method benchmarking developed by Weber et al. [-@weber2019] (See [Box 1](#box1)).\n\n::: {#box1 .box}\n\n\n\n::: {.cell}\n::: {.cell-output-display}\n\n```{=html}\n<div id=\"oobrzvuccc\" style=\"padding-left:0px;padding-right:0px;padding-top:0px;padding-bottom:0px;overflow-x:auto;overflow-y:auto;width:auto;height:auto;\">\n<style>#oobrzvuccc table {\n  font-family: system-ui, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif, 'Apple Color Emoji', 'Segoe UI Emoji', 'Segoe UI Symbol', 'Noto Color Emoji';\n  -webkit-font-smoothing: antialiased;\n  -moz-osx-font-smoothing: grayscale;\n}\n\n#oobrzvuccc thead, #oobrzvuccc tbody, #oobrzvuccc tfoot, #oobrzvuccc tr, #oobrzvuccc td, #oobrzvuccc th {\n  border-style: none;\n}\n\n#oobrzvuccc p {\n  margin: 0;\n  padding: 0;\n}\n\n#oobrzvuccc .gt_table {\n  display: table;\n  border-collapse: collapse;\n  line-height: normal;\n  margin-left: auto;\n  margin-right: auto;\n  color: #333333;\n  font-size: 16px;\n  font-weight: normal;\n  font-style: normal;\n  background-color: #FFFFFF;\n  width: auto;\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #A8A8A8;\n  border-right-style: none;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #A8A8A8;\n  border-left-style: none;\n  border-left-width: 2px;\n  border-left-color: #D3D3D3;\n}\n\n#oobrzvuccc .gt_caption {\n  padding-top: 4px;\n  padding-bottom: 4px;\n}\n\n#oobrzvuccc .gt_title {\n  color: #333333;\n  font-size: 125%;\n  font-weight: initial;\n  padding-top: 4px;\n  padding-bottom: 4px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-bottom-color: #FFFFFF;\n  border-bottom-width: 0;\n}\n\n#oobrzvuccc .gt_subtitle {\n  color: #333333;\n  font-size: 85%;\n  font-weight: initial;\n  padding-top: 3px;\n  padding-bottom: 5px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-top-color: #FFFFFF;\n  border-top-width: 0;\n}\n\n#oobrzvuccc .gt_heading {\n  background-color: #FFFFFF;\n  text-align: center;\n  border-bottom-color: #FFFFFF;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n}\n\n#oobrzvuccc .gt_bottom_border {\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n}\n\n#oobrzvuccc .gt_col_headings {\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n}\n\n#oobrzvuccc .gt_col_heading {\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: normal;\n  text-transform: inherit;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n  vertical-align: bottom;\n  padding-top: 5px;\n  padding-bottom: 6px;\n  padding-left: 5px;\n  padding-right: 5px;\n  overflow-x: hidden;\n}\n\n#oobrzvuccc .gt_column_spanner_outer {\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: normal;\n  text-transform: inherit;\n  padding-top: 0;\n  padding-bottom: 0;\n  padding-left: 4px;\n  padding-right: 4px;\n}\n\n#oobrzvuccc .gt_column_spanner_outer:first-child {\n  padding-left: 0;\n}\n\n#oobrzvuccc .gt_column_spanner_outer:last-child {\n  padding-right: 0;\n}\n\n#oobrzvuccc .gt_column_spanner {\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  vertical-align: bottom;\n  padding-top: 5px;\n  padding-bottom: 5px;\n  overflow-x: hidden;\n  display: inline-block;\n  width: 100%;\n}\n\n#oobrzvuccc .gt_spanner_row {\n  border-bottom-style: hidden;\n}\n\n#oobrzvuccc .gt_group_heading {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: initial;\n  text-transform: inherit;\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n  vertical-align: middle;\n  text-align: left;\n}\n\n#oobrzvuccc .gt_empty_group_heading {\n  padding: 0.5px;\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: initial;\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  vertical-align: middle;\n}\n\n#oobrzvuccc .gt_from_md > :first-child {\n  margin-top: 0;\n}\n\n#oobrzvuccc .gt_from_md > :last-child {\n  margin-bottom: 0;\n}\n\n#oobrzvuccc .gt_row {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  margin: 10px;\n  border-top-style: solid;\n  border-top-width: 1px;\n  border-top-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n  vertical-align: middle;\n  overflow-x: hidden;\n}\n\n#oobrzvuccc .gt_stub {\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: initial;\n  text-transform: inherit;\n  border-right-style: solid;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#oobrzvuccc .gt_stub_row_group {\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: initial;\n  text-transform: inherit;\n  border-right-style: solid;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n  padding-left: 5px;\n  padding-right: 5px;\n  vertical-align: top;\n}\n\n#oobrzvuccc .gt_row_group_first td {\n  border-top-width: 2px;\n}\n\n#oobrzvuccc .gt_row_group_first th {\n  border-top-width: 2px;\n}\n\n#oobrzvuccc .gt_summary_row {\n  color: #333333;\n  background-color: #FFFFFF;\n  text-transform: inherit;\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#oobrzvuccc .gt_first_summary_row {\n  border-top-style: solid;\n  border-top-color: #D3D3D3;\n}\n\n#oobrzvuccc .gt_first_summary_row.thick {\n  border-top-width: 2px;\n}\n\n#oobrzvuccc .gt_last_summary_row {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n}\n\n#oobrzvuccc .gt_grand_summary_row {\n  color: #333333;\n  background-color: #FFFFFF;\n  text-transform: inherit;\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#oobrzvuccc .gt_first_grand_summary_row {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-top-style: double;\n  border-top-width: 6px;\n  border-top-color: #D3D3D3;\n}\n\n#oobrzvuccc .gt_last_grand_summary_row_top {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-bottom-style: double;\n  border-bottom-width: 6px;\n  border-bottom-color: #D3D3D3;\n}\n\n#oobrzvuccc .gt_striped {\n  background-color: rgba(128, 128, 128, 0.05);\n}\n\n#oobrzvuccc .gt_table_body {\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n}\n\n#oobrzvuccc .gt_footnotes {\n  color: #333333;\n  background-color: #FFFFFF;\n  border-bottom-style: none;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 2px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n}\n\n#oobrzvuccc .gt_footnote {\n  margin: 0px;\n  font-size: 90%;\n  padding-top: 4px;\n  padding-bottom: 4px;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#oobrzvuccc .gt_sourcenotes {\n  color: #333333;\n  background-color: #FFFFFF;\n  border-bottom-style: none;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 2px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n}\n\n#oobrzvuccc .gt_sourcenote {\n  font-size: 90%;\n  padding-top: 4px;\n  padding-bottom: 4px;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#oobrzvuccc .gt_left {\n  text-align: left;\n}\n\n#oobrzvuccc .gt_center {\n  text-align: center;\n}\n\n#oobrzvuccc .gt_right {\n  text-align: right;\n  font-variant-numeric: tabular-nums;\n}\n\n#oobrzvuccc .gt_font_normal {\n  font-weight: normal;\n}\n\n#oobrzvuccc .gt_font_bold {\n  font-weight: bold;\n}\n\n#oobrzvuccc .gt_font_italic {\n  font-style: italic;\n}\n\n#oobrzvuccc .gt_super {\n  font-size: 65%;\n}\n\n#oobrzvuccc .gt_footnote_marks {\n  font-size: 75%;\n  vertical-align: 0.4em;\n  position: initial;\n}\n\n#oobrzvuccc .gt_asterisk {\n  font-size: 100%;\n  vertical-align: 0;\n}\n\n#oobrzvuccc .gt_indent_1 {\n  text-indent: 5px;\n}\n\n#oobrzvuccc .gt_indent_2 {\n  text-indent: 10px;\n}\n\n#oobrzvuccc .gt_indent_3 {\n  text-indent: 15px;\n}\n\n#oobrzvuccc .gt_indent_4 {\n  text-indent: 20px;\n}\n\n#oobrzvuccc .gt_indent_5 {\n  text-indent: 25px;\n}\n\n#oobrzvuccc .katex-display {\n  display: inline-flex !important;\n  margin-bottom: 0.75em !important;\n}\n\n#oobrzvuccc div.Reactable > div.rt-table > div.rt-thead > div.rt-tr.rt-tr-group-header > div.rt-th-group:after {\n  height: 0px !important;\n}\n</style>\n<table class=\"gt_table\" data-quarto-disable-processing=\"false\" data-quarto-bootstrap=\"false\">\n  <thead>\n    <tr class=\"gt_heading\">\n      <td colspan=\"2\" class=\"gt_heading gt_title gt_font_normal gt_bottom_border\" style=\"border-top-width: 1px; border-top-style: hidden; border-top-color: #000000;\">Box 1: Computational benchmarking guidelines</td>\n    </tr>\n    \n  </thead>\n  <tbody class=\"gt_table_body\">\n    <tr><td headers=\"num\" class=\"gt_row gt_right\">1</td>\n<td headers=\"guide\" class=\"gt_row gt_left\">Define the purpose and the scope of the benchmark.</td></tr>\n    <tr><td headers=\"num\" class=\"gt_row gt_right\">2</td>\n<td headers=\"guide\" class=\"gt_row gt_left\">Include all relevant methods.</td></tr>\n    <tr><td headers=\"num\" class=\"gt_row gt_right\">3</td>\n<td headers=\"guide\" class=\"gt_row gt_left\">Select (or design) appropriate datasets.</td></tr>\n    <tr><td headers=\"num\" class=\"gt_row gt_right\">4</td>\n<td headers=\"guide\" class=\"gt_row gt_left\">Choose appropriate parameter values and software versions.</td></tr>\n    <tr><td headers=\"num\" class=\"gt_row gt_right\">5</td>\n<td headers=\"guide\" class=\"gt_row gt_left\">Evaluate methods according to key quantitative performance metrics.</td></tr>\n    <tr><td headers=\"num\" class=\"gt_row gt_right\">6</td>\n<td headers=\"guide\" class=\"gt_row gt_left\">Evaluate secondary metrics including computational requirements, user-friendliness, installation procedures, and documentation quality.</td></tr>\n    <tr><td headers=\"num\" class=\"gt_row gt_right\">7</td>\n<td headers=\"guide\" class=\"gt_row gt_left\">Interpret results and provide recommendations from both user and method developer perspectives.</td></tr>\n    <tr><td headers=\"num\" class=\"gt_row gt_right\">8</td>\n<td headers=\"guide\" class=\"gt_row gt_left\">Publish results in an accessible format.</td></tr>\n    <tr><td headers=\"num\" class=\"gt_row gt_right\">9</td>\n<td headers=\"guide\" class=\"gt_row gt_left\">Design the benchmark to include future extensions.</td></tr>\n    <tr><td headers=\"num\" class=\"gt_row gt_right\">10</td>\n<td headers=\"guide\" class=\"gt_row gt_left\">Follow reproducible research best practices, by making code and data publicly available.</td></tr>\n  </tbody>\n  \n  \n</table>\n</div>\n```\n\n:::\n:::\n\n\n\n:::\n\n## Basic simulation steps\n\n1. Create a normal distribution of the body size variable\n2. Calculate probability of maturity for each individual based on body size\n3. Calculate predicted claw or abdomen size based on body size\n4. Add error\n\nThe `fake_crustaceans` function in `morphmat` allows users to rapidly generate many data sets with options for changing parameters in each of the four steps.\n\nIn more detail:\n\n1.  Create a normal distribution of the body size variable with the specified mean and SD. The `fake_crustaceans` default is to generate a random sample of 1000 crustaceans with a mean carapace width/body size of 105 mm and standard deviation of 20 mm. \n\n\n\n\n::: {.cell}\n\n:::\n\n::: {.cell}\n::: {.cell-output-display}\n![Histogram of carapace widths](simulation_testing_files/figure-html/fig-defaulthist-1.png){#fig-defaulthist width=80%}\n:::\n:::\n\n\n\n\n2.  Use a logistic distribution with known location and scale parameters (i.e., known L50 and steepness of the logistic curve) to find the probability of maturity for each individual based on their body size. The `fake_crustaceans` default is for the true size at maturity for the population to be 100 mm, with a slope parameter for the logistic equation of 5. \n\nThe parameterization of the logistic equation we will use is: $$f(x)=\\frac{1}{1+e^{-(x-a)/b}} $$ where $a$ is a location parameter and $b$ is the shape parameter.\n\n\n\n\n::: {.cell}\n::: {.cell-output-display}\n![Distribution of carapace widths by maturity level](simulation_testing_files/figure-html/fig-defaultdensity-1.png){#fig-defaultdensity width=80%}\n:::\n:::\n\n\n\n\n3.  Using given parameters for the slope and intercept of the allometric equation, find the predicted chela height for each individual based on their carapace width. \n\nThe allometric growth equation is \\\\begin{equation}\\label{eqn:allometry}Y=\\\\beta X\\^{\\\\alpha},\\\\end{equation}\n\nwhich results in a linear plot when log-transformed: $\\log{(Y)}= \\tilde\\beta+\\alpha \\log{(X)}$. Here, $\\alpha$ is the slope of the allometric line and $\\beta$ is the intercept, with $\\tilde{\\beta}=\\log{(\\beta)}$. Differences in the intercept of the allometry indicate differences in the proportionate size of the chela, irrespective of carapace width. In contrast, differences in the slope parameter represent differences in how the relative size of the chela changes with body size.\n\nThe `fake_crustaceans` default is no change in the allometric slope or intercept parameters $(\\alpha=1.2, \\beta=0.1)$ upon reaching maturity, so if this was real data, we would not actually be able to estimate size at maturity based on a change in morphometric ratios. The SD of the error distribution also remains constant upon reaching maturity.\n\n\n\n\n::: {.cell}\n::: {.cell-output-display}\n![Carapace width vs. chela height using the default simulation parameters. Vertical grey lines represent the size at maturity used in the logistic equation (100 mm).](simulation_testing_files/figure-html/fig-defaultlineserror-1.png){#fig-defaultlineserror width=672}\n:::\n:::\n\n\n\n\n4.  Add error representing individual variation in allometric growth. Errors added in Step 4 are assumed to be normally distributed around the regression lines obtained by log-transforming the raw CW and CH values. In other words, the data are assumed to have multiplicative log-normally distributed error:\n\n$$Y=\\beta X^{\\alpha}e^{\\varepsilon}, \\quad \\varepsilon \\sim N(0,\\sigma^2)$$ $$\\log{(Y)}=\\log{(\\beta)}+ \\alpha\\log{(X)}+\\varepsilon, \\quad \\varepsilon \\sim N(0,\\sigma^2)$$\n\nThe question of whether error structures should be assumed to be multiplicative or additive when fitting allometric models is non-trivial and often controversial [@packard2009; @ballantyne2013; @xiao2011]. However, the assumption of multiplicative error is often appropriate for biological contexts and in this case, simulating error based on a multiplicative structure generates artificial data sets that adequately resemble the empirical morphometric data sets we are interested in [@xiao2011; @kerkhoff2009]. Variance in empirical size-at-maturity data often appears higher for mature individuals, so by assuming a multiplicative error structure, these errors will be proportional to the x-axis variable. For example, a measurement error of 4 mm would be less likely to occur when measuring a crab with a carapace that is 30 mm in length (a 13% error) than for a crab with a 100-mm carapace (a 4% error). Alternative error distributions for allometric models continue to be developed, and future extensions of our research could consider the performance of various size-at-maturity models when applied to simulated data with different forms of error [@echavarr√≠a-heras2024].\n\n## References {.unnumbered}\n",
    "supporting": [
      "simulation_testing_files"
    ],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {},
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}